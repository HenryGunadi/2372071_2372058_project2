<!DOCTYPE html>
<html lang="en">
    <head>
        <!-- Required meta tags -->
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <title>Admin Page</title>
        <!-- plugins:css -->
        <link rel="stylesheet" href="assetsStaff/vendors/mdi/css/materialdesignicons.min.css" />
        <link rel="stylesheet" href="assetsStaff/vendors/css/vendor.bundle.base.css" />
        <!-- endinject -->
        <!-- Plugin css for this page -->
        <link rel="stylesheet" href="assetsStaff/vendors/jvectormap/jquery-jvectormap.css" />
        <link rel="stylesheet" href="assetsStaff/vendors/flag-icon-css/css/flag-icon.min.css" />
        <link rel="stylesheet" href="assetsStaff/vendors/owl-carousel-2/owl.carousel.min.css" />
        <link rel="stylesheet" href="assetsStaff/vendors/owl-carousel-2/owl.theme.default.min.css" />
        <!-- End plugin css for this page -->
        <!-- inject:css -->
        <!-- endinject -->
        <!-- Layout styles -->
        <link rel="stylesheet" href="assetsStaff/css/style.css" />
        <!-- End layout styles -->
        <link rel="shortcut icon" href="assetsStaff/images/favicon.png" />
        <!-- <style>
      .container-scroller {
        display: none;
      }
    </style> -->
        <style>
            .badge-outline-success {
                background-color: #d4edda;
                color: #155724;
                border: 1px solid #c3e6cb;
                padding: 4px 8px;
                border-radius: 4px;
                font-size: 12px;
            }
            .badge-outline-warning {
                background-color: #fff3cd;
                color: #856404;
                border: 1px solid #ffeaa7;
                padding: 4px 8px;
                border-radius: 4px;
                font-size: 12px;
            }
            .badge-outline-danger {
                background-color: #f8d7da;
                color: #721c24;
                border: 1px solid #f5c6cb;
                padding: 4px 8px;
                border-radius: 4px;
                font-size: 12px;
            }
            .badge-outline-secondary {
                background-color: #e2e3e5;
                color: #6c757d;
                border: 1px solid #d6d8db;
                padding: 4px 8px;
                border-radius: 4px;
                font-size: 12px;
            }

            .table tbody tr:hover {
                background-color: rgba(255, 255, 255, 0.1);
                cursor: pointer;
            }

            /* Custom Registration Details Overlay */
            .reg-overlay {
                display: none;
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background-color: rgba(0, 0, 0, 0.7);
                z-index: 9999;
            }

            .reg-details-container {
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: #2a2d3a;
                color: #fff;
                width: 90%;
                max-width: 900px;
                max-height: 90vh;
                border-radius: 8px;
                overflow-y: auto;
                box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            }

            .reg-header {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                padding: 20px;
                border-radius: 8px 8px 0 0;
                display: flex;
                justify-content: space-between;
                align-items: center;
            }

            .reg-header h3 {
                margin: 0;
                font-size: 18px;
            }

            .reg-close {
                background: none;
                border: none;
                color: white;
                font-size: 24px;
                cursor: pointer;
                padding: 0;
                width: 30px;
                height: 30px;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .reg-close:hover {
                background-color: rgba(255, 255, 255, 0.2);
                border-radius: 4px;
            }

            .reg-content {
                padding: 20px;
            }

            .reg-section {
                margin-bottom: 30px;
            }

            .reg-section-title {
                font-size: 16px;
                margin-bottom: 15px;
                color: #667eea;
                border-bottom: 1px solid #444;
                padding-bottom: 8px;
            }

            .reg-row {
                display: flex;
                flex-wrap: wrap;
                gap: 30px;
            }

            .reg-col {
                flex: 1;
                min-width: 300px;
            }

            .reg-info-item {
                margin-bottom: 12px;
                display: flex;
                justify-content: space-between;
                align-items: flex-start;
            }

            .reg-label {
                font-weight: 600;
                color: #bbb;
                margin-right: 10px;
                min-width: 120px;
            }

            .reg-value {
                color: #fff;
                flex: 1;
                text-align: right;
            }

            .reg-image {
                max-width: 150px;
                height: auto;
                border-radius: 6px;
                border: 1px solid #444;
            }

            .reg-proof-image {
                max-width: 200px;
                height: auto;
                border-radius: 6px;
                border: 1px solid #444;
            }

            .reg-status-section {
                background: #333;
                padding: 20px;
                border-radius: 6px;
                margin-top: 20px;
            }

            .reg-status-current {
                display: flex;
                align-items: center;
                margin-bottom: 15px;
                gap: 10px;
            }

            .reg-status-buttons {
                display: flex;
                gap: 10px;
                flex-wrap: wrap;
            }

            .reg-btn {
                padding: 8px 16px;
                border: none;
                border-radius: 4px;
                cursor: pointer;
                font-size: 13px;
                font-weight: 500;
                transition: all 0.2s;
            }

            .reg-btn-success {
                background-color: #28a745;
                color: white;
            }

            .reg-btn-success:hover {
                background-color: #218838;
            }

            .reg-btn-danger {
                background-color: #dc3545;
                color: white;
            }

            .reg-btn-danger:hover {
                background-color: #c82333;
            }

            .reg-btn-warning {
                background-color: #ffc107;
                color: #212529;
            }

            .reg-btn-warning:hover {
                background-color: #e0a800;
            }

            .reg-btn-link {
                background-color: #007bff;
                color: white;
                text-decoration: none;
                display: inline-block;
            }

            .reg-btn-link:hover {
                background-color: #0056b3;
                color: white;
                text-decoration: none;
            }

            @media (max-width: 768px) {
                .reg-details-container {
                    width: 95%;
                    margin: 20px;
                }

                .reg-row {
                    flex-direction: column;
                    gap: 20px;
                }

                .reg-col {
                    min-width: auto;
                }

                .reg-info-item {
                    flex-direction: column;
                    gap: 4px;
                }

                .reg-value {
                    text-align: left;
                }

                .reg-status-buttons {
                    flex-direction: column;
                }
            }
        </style>
    </head>
    <body>
        <div class="container-scroller">
            <!-- Modal -->
            <div class="modal fade" id="eventModal" tabindex="-1" aria-labelledby="eventModalLabel" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="eventModalLabel">Event Details</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body" id="eventModalBody">
                            <!-- Dynamic event detail content goes here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Registration Details Overlay -->
            <div class="reg-overlay" id="registrationOverlay">
                <div class="reg-details-container">
                    <div class="reg-header">
                        <h3>üìã Registration Details</h3>
                        <button class="reg-close" onclick="closeRegistrationDetails()">&times;</button>
                    </div>
                    <div class="reg-content">
                        <!-- Registration Information Section -->
                        <div class="reg-section">
                            <div class="reg-row">
                                <div class="reg-col">
                                    <h4 class="reg-section-title">üë§ Registration Information</h4>
                                    <div class="reg-info-item"><span class="reg-label">Registration ID:</span><span class="reg-value" id="detail-reg-id">‚Äî</span></div>
                                    <div class="reg-info-item"><span class="reg-label">Client Email:</span><span class="reg-value" id="detail-email">‚Äî</span></div>
                                    <div class="reg-info-item"><span class="reg-label">Registration Date:</span><span class="reg-value" id="detail-reg-date">‚Äî</span></div>
                                    <div class="reg-info-item"><span class="reg-label">Last Updated:</span><span class="reg-value" id="detail-updated-date">‚Äî</span></div>
                                    <div class="reg-info-item"><span class="reg-label">Attendance:</span><span class="reg-value" id="detail-absence">‚Äî</span></div>
                                    <div class="reg-info-item"><span class="reg-label">QR Code:</span><span class="reg-value" id="detail-qr-code">‚Äî</span></div>
                                </div>

                                <div class="reg-col">
                                    <h4 class="reg-section-title">üìÖ Event Information</h4>
                                    <div class="reg-info-item"><span class="reg-label">Event Title:</span><span class="reg-value" id="detail-event-title">‚Äî</span></div>
                                    <div class="reg-info-item"><span class="reg-label">Event Price:</span><span class="reg-value" id="detail-event-price">‚Äî</span></div>
                                    <div class="reg-info-item"><span class="reg-label">Max Participants:</span><span class="reg-value" id="detail-max-participants">‚Äî</span></div>
                                    <div class="reg-info-item"><span class="reg-label">Total Registered:</span><span class="reg-value" id="detail-total-registered">‚Äî</span></div>
                                    <div class="reg-info-item"><span class="reg-label">Event Status:</span><span class="reg-value" id="detail-event-status">‚Äî</span></div>
                                    <div class="reg-info-item"><span class="reg-label">Event Poster:</span><div class="reg-value" id="detail-event-poster">‚Äî</div></div>
                                </div>
                            </div>
                        </div>

                        <!-- Proof of Payment Section -->
                        <div class="reg-section">
                            <h4 class="reg-section-title">üí≥ Proof of Payment</h4>
                            <div id="detail-proof-container" style="text-align: center">‚Äî</div>
                        </div>

                        <!-- Upload Certificate Section (Committee only) -->
                        <div class="reg-section" id="certificate-upload-section" style="display: none">
                            <h4 class="reg-section-title">üèÖ Upload Certificate</h4>
                            <form id="certificateUploadForm">
                                <input type="file" id="certificateFile" accept="image/*,.pdf" required />
                                <button type="submit" class="reg-btn reg-btn-primary">üì§ Upload Certificate</button>
                            </form>
                        </div>

                        <!-- Status Update Section (Non-committee only) -->
                        <div class="reg-status-section">
                            <h4 class="reg-section-title">üí∞ Payment Status Management</h4>
                            <div class="reg-status-current">
                                <span>Current Status:</span>
                                <span id="detail-current-status">‚Äî</span>
                            </div>
                            <div class="reg-status-buttons">
                                <button class="reg-btn reg-btn-success" onclick="updateRegistrationStatus('paid')">‚úÖ Mark as Paid</button>
                                <button class="reg-btn reg-btn-danger" onclick="updateRegistrationStatus('rejected')">‚ùå Reject Payment</button>
                                <button class="reg-btn reg-btn-warning" onclick="updateRegistrationStatus('pending')">‚è≥ Set Pending</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>


            <!-- partial:partials/_sidebar.html -->
            <nav class="sidebar sidebar-offcanvas" id="sidebar">
                <div class="sidebar-brand-wrapper d-none d-lg-flex align-items-center justify-content-center fixed-top">
                    <a class="sidebar-brand brand-logo" href="#"><img src="assetsStaff/images/logo.svg" alt="logo" /></a>
                    <a class="sidebar-brand brand-logo-mini" href="#"><img src="assetsStaff/images/logo-mini.svg" alt="logo" /></a>
                </div>
                <ul class="nav">
                    <li class="nav-item profile">
                        <div class="profile-desc">
                            <div class="profile-pic">
                                <div class="count-indicator">
                                    <img class="img-xs rounded-circle" src="assetsStaff/images/faces/face15.jpg" alt="" />
                                    <span class="count bg-success"></span>
                                </div>
                                <div class="profile-name">
                                    <h5 class="mb-0 font-weight-normal" id="username"></h5>
                                    <span id="role"></span>
                                </div>
                            </div>
                            <a href="#" id="profile-dropdown" data-toggle="dropdown"><i class="mdi mdi-dots-vertical"></i></a>
                            <div class="dropdown-menu dropdown-menu-right sidebar-dropdown preview-list" aria-labelledby="profile-dropdown">
                                <a href="#" class="dropdown-item preview-item">
                                    <div class="preview-thumbnail">
                                        <div class="preview-icon bg-dark rounded-circle">
                                            <i class="mdi mdi-settings text-primary"></i>
                                        </div>
                                    </div>
                                    <div class="preview-item-content">
                                        <p class="preview-subject ellipsis mb-1 text-small">Account settings</p>
                                    </div>
                                </a>
                                <div class="dropdown-divider"></div>
                                <a href="#" class="dropdown-item preview-item">
                                    <div class="preview-thumbnail">
                                        <div class="preview-icon bg-dark rounded-circle">
                                            <i class="mdi mdi-onepassword text-info"></i>
                                        </div>
                                    </div>
                                    <div class="preview-item-content">
                                        <p class="preview-subject ellipsis mb-1 text-small">Change Password</p>
                                    </div>
                                </a>
                                <div class="dropdown-divider"></div>
                                <a href="#" class="dropdown-item preview-item">
                                    <div class="preview-thumbnail">
                                        <div class="preview-icon bg-dark rounded-circle">
                                            <i class="mdi mdi-calendar-today text-success"></i>
                                        </div>
                                    </div>
                                    <div class="preview-item-content">
                                        <p class="preview-subject ellipsis mb-1 text-small">To-do list</p>
                                    </div>
                                </a>
                            </div>
                        </div>
                    </li>
                    <li class="nav-item nav-category">
                        <span class="nav-link">Navigation</span>
                    </li>
                    <li class="nav-item menu-items">
                        <a class="nav-link" href="staffDashboard.html">
                            <span class="menu-icon">
                                <i class="mdi mdi-speedometer"></i>
                            </span>
                            <span class="menu-title">Dashboard</span>
                        </a>
                    </li>
                    <li class="nav-item menu-items">
                        <a class="nav-link" href="pages/forms/basic_elements.html">
                            <span class="menu-icon">
                                <i class="mdi mdi-playlist-play"></i>
                            </span>
                            <span class="menu-title">Event</span>
                        </a>
                    </li>
                    <li class="nav-item menu-items">
                        <a class="nav-link" href="pages/tables/basic-table.html">
                            <span class="menu-icon">
                                <i class="mdi mdi-table-large"></i>
                            </span>
                            <span class="menu-title">Staff</span>
                        </a>
                    </li>
                    <li class="nav-item menu-items">
                        <a class="nav-link" href="pages/icons/mdi.html">
                            <span class="menu-icon">
                                <i class="mdi mdi-contacts"></i>
                            </span>
                            <span class="menu-title">Scan</span>
                        </a>
                    </li>
                </ul>
            </nav>
            <!-- partial -->
            <div class="container-fluid page-body-wrapper">
                <!-- partial:partials/_navbar.html -->
                <nav class="navbar p-0 fixed-top d-flex flex-row">
                    <div class="navbar-brand-wrapper d-flex d-lg-none align-items-center justify-content-center">
                        <a class="navbar-brand brand-logo-mini" href="index.html"><img src="assetsStaff/images/logo-mini.svg" alt="logo" /></a>
                    </div>
                    <div class="navbar-menu-wrapper flex-grow d-flex align-items-stretch">
                        <button class="navbar-toggler navbar-toggler align-self-center" type="button" data-toggle="minimize">
                            <span class="mdi mdi-menu"></span>
                        </button>
                        <ul class="navbar-nav w-100">
                            <li class="nav-item w-100">
                                <form class="nav-link mt-2 mt-md-0 d-none d-lg-flex search">
                                    <input type="text" class="form-control" placeholder="Search products" />
                                </form>
                            </li>
                        </ul>
                        <ul class="navbar-nav navbar-nav-right">
                            <li class="nav-item dropdown d-none d-lg-block">
                                <a class="nav-link btn btn-success create-new-button" id="createbuttonDropdown" data-toggle="dropdown" aria-expanded="false" href="#">+ Create New Event</a>
                                <div class="dropdown-menu dropdown-menu-right navbar-dropdown preview-list" aria-labelledby="createbuttonDropdown">
                                    <h6 class="p-3 mb-0">Projects</h6>
                                    <div class="dropdown-divider"></div>
                                    <a class="dropdown-item preview-item">
                                        <div class="preview-thumbnail">
                                            <div class="preview-icon bg-dark rounded-circle">
                                                <i class="mdi mdi-file-outline text-primary"></i>
                                            </div>
                                        </div>
                                        <div class="preview-item-content">
                                            <p class="preview-subject ellipsis mb-1">Software Development</p>
                                        </div>
                                    </a>
                                    <div class="dropdown-divider"></div>
                                    <a class="dropdown-item preview-item">
                                        <div class="preview-thumbnail">
                                            <div class="preview-icon bg-dark rounded-circle">
                                                <i class="mdi mdi-web text-info"></i>
                                            </div>
                                        </div>
                                        <div class="preview-item-content">
                                            <p class="preview-subject ellipsis mb-1">UI Development</p>
                                        </div>
                                    </a>
                                    <div class="dropdown-divider"></div>
                                    <a class="dropdown-item preview-item">
                                        <div class="preview-thumbnail">
                                            <div class="preview-icon bg-dark rounded-circle">
                                                <i class="mdi mdi-layers text-danger"></i>
                                            </div>
                                        </div>
                                        <div class="preview-item-content">
                                            <p class="preview-subject ellipsis mb-1">Software Testing</p>
                                        </div>
                                    </a>
                                    <div class="dropdown-divider"></div>
                                    <p class="p-3 mb-0 text-center">See all projects</p>
                                </div>
                            </li>
                            <li class="nav-item nav-settings d-none d-lg-block">
                                <a class="nav-link" href="#">
                                    <i class="mdi mdi-view-grid"></i>
                                </a>
                            </li>
                            <li class="nav-item dropdown border-left">
                                <a class="nav-link count-indicator dropdown-toggle" id="messageDropdown" href="#" data-toggle="dropdown" aria-expanded="false">
                                    <i class="mdi mdi-email"></i>
                                    <span class="count bg-success"></span>
                                </a>
                                <div class="dropdown-menu dropdown-menu-right navbar-dropdown preview-list" aria-labelledby="messageDropdown">
                                    <h6 class="p-3 mb-0">Messages</h6>
                                    <div class="dropdown-divider"></div>
                                    <a class="dropdown-item preview-item">
                                        <div class="preview-thumbnail">
                                            <img src="assetsStaff/images/faces/face4.jpg" alt="image" class="rounded-circle profile-pic" />
                                        </div>
                                        <div class="preview-item-content">
                                            <p class="preview-subject ellipsis mb-1">Mark send you a message</p>
                                            <p class="text-muted mb-0">1 Minutes ago</p>
                                        </div>
                                    </a>
                                    <div class="dropdown-divider"></div>
                                    <a class="dropdown-item preview-item">
                                        <div class="preview-thumbnail">
                                            <img src="assetsStaff/images/faces/face2.jpg" alt="image" class="rounded-circle profile-pic" />
                                        </div>
                                        <div class="preview-item-content">
                                            <p class="preview-subject ellipsis mb-1">Cregh send you a message</p>
                                            <p class="text-muted mb-0">15 Minutes ago</p>
                                        </div>
                                    </a>
                                    <div class="dropdown-divider"></div>
                                    <a class="dropdown-item preview-item">
                                        <div class="preview-thumbnail">
                                            <img src="assetsStaff/images/faces/face3.jpg" alt="image" class="rounded-circle profile-pic" />
                                        </div>
                                        <div class="preview-item-content">
                                            <p class="preview-subject ellipsis mb-1">Profile picture updated</p>
                                            <p class="text-muted mb-0">18 Minutes ago</p>
                                        </div>
                                    </a>
                                    <div class="dropdown-divider"></div>
                                    <p class="p-3 mb-0 text-center">4 new messages</p>
                                </div>
                            </li>
                            <li class="nav-item dropdown border-left">
                                <a class="nav-link count-indicator dropdown-toggle" id="notificationDropdown" href="#" data-toggle="dropdown">
                                    <i class="mdi mdi-bell"></i>
                                    <span class="count bg-danger"></span>
                                </a>
                                <div class="dropdown-menu dropdown-menu-right navbar-dropdown preview-list" aria-labelledby="notificationDropdown">
                                    <h6 class="p-3 mb-0">Notifications</h6>
                                    <div class="dropdown-divider"></div>
                                    <a class="dropdown-item preview-item">
                                        <div class="preview-thumbnail">
                                            <div class="preview-icon bg-dark rounded-circle">
                                                <i class="mdi mdi-calendar text-success"></i>
                                            </div>
                                        </div>
                                        <div class="preview-item-content">
                                            <p class="preview-subject mb-1">Event today</p>
                                            <p class="text-muted ellipsis mb-0">Just a reminder that you have an event today</p>
                                        </div>
                                    </a>
                                    <div class="dropdown-divider"></div>
                                    <a class="dropdown-item preview-item">
                                        <div class="preview-thumbnail">
                                            <div class="preview-icon bg-dark rounded-circle">
                                                <i class="mdi mdi-settings text-danger"></i>
                                            </div>
                                        </div>
                                        <div class="preview-item-content">
                                            <p class="preview-subject mb-1">Settings</p>
                                            <p class="text-muted ellipsis mb-0">Update dashboard</p>
                                        </div>
                                    </a>
                                    <div class="dropdown-divider"></div>
                                    <a class="dropdown-item preview-item">
                                        <div class="preview-thumbnail">
                                            <div class="preview-icon bg-dark rounded-circle">
                                                <i class="mdi mdi-link-variant text-warning"></i>
                                            </div>
                                        </div>
                                        <div class="preview-item-content">
                                            <p class="preview-subject mb-1">Launch Admin</p>
                                            <p class="text-muted ellipsis mb-0">New admin wow!</p>
                                        </div>
                                    </a>
                                    <div class="dropdown-divider"></div>
                                    <p class="p-3 mb-0 text-center">See all notifications</p>
                                </div>
                            </li>
                            <li class="nav-item dropdown">
                                <a class="nav-link" id="profileDropdown" href="#" data-toggle="dropdown">
                                    <div class="navbar-profile">
                                        <img class="img-xs rounded-circle" src="assetsStaff/images/faces/face15.jpg" alt="" />
                                        <p class="mb-0 d-none d-sm-block navbar-profile-name" id="username-navbar"></p>
                                        <i class="mdi mdi-menu-down d-none d-sm-block" id="role"></i>
                                    </div>
                                </a>
                                <div class="dropdown-menu dropdown-menu-right navbar-dropdown preview-list" aria-labelledby="profileDropdown">
                                    <h6 class="p-3 mb-0">Profile</h6>
                                    <div class="dropdown-divider"></div>
                                    <a class="dropdown-item preview-item">
                                        <div class="preview-thumbnail">
                                            <div class="preview-icon bg-dark rounded-circle">
                                                <i class="mdi mdi-settings text-success"></i>
                                            </div>
                                        </div>
                                        <div class="preview-item-content">
                                            <p class="preview-subject mb-1">Settings</p>
                                        </div>
                                    </a>
                                    <div class="dropdown-divider"></div>
                                    <a class="dropdown-item preview-item">
                                        <div class="preview-thumbnail">
                                            <div class="preview-icon bg-dark rounded-circle">
                                                <i class="mdi mdi-logout text-danger"></i>
                                            </div>
                                        </div>
                                        <div class="preview-item-content" id="logout-btn">
                                            <p class="preview-subject mb-1" >Log out</p>
                                        </div>
                                    </a>
                                    <div class="dropdown-divider"></div>
                                    <p class="p-3 mb-0 text-center">Advanced settings</p>
                                </div>
                            </li>
                        </ul>
                        <button class="navbar-toggler navbar-toggler-right d-lg-none align-self-center" type="button" data-toggle="offcanvas">
                            <span class="mdi mdi-format-line-spacing"></span>
                        </button>
                    </div>
                </nav>
                <!-- partial -->
                <div class="main-panel">
                    <div class="content-wrapper">
                        <div class="row">
                            <div class="col-12 grid-margin stretch-card">
                                    <div class="card-body py-0 px-0 px-sm-3">
                                        <div class="row align-items-center">
                                            <!-- <div class="col-4 col-sm-3 col-xl-2">
                                                <img src="assetsStaff/images/dashboard/Group126@2x.png" class="gradient-corona-img img-fluid" alt="" />
                                            </div> -->
                                            <!-- <div class="col-5 col-sm-7 col-xl-8 p-0">
                                                <h4 class="mb-1 mb-sm-0">Want even more features?</h4>
                                                <p class="mb-0 font-weight-normal d-none d-sm-block">Check out our Pro version with 5 unique layouts!</p>
                                            </div> -->
                                            <!-- <div class="col-3 col-sm-2 col-xl-2 pl-0 text-center">
                                                <span>
                                                    <a href="https://www.bootstrapdash.com/product/corona-admin-template/" target="_blank" class="btn btn-outline-light btn-rounded get-started-btn">Upgrade to PRO</a>
                                                </span>
                                            </div> -->
                                        </div>
                                    </div>
                            </div>
                        </div>
                        <!-- <div class="row">
                            <div class="col-xl-3 col-sm-6 grid-margin stretch-card">
                                <div class="card">
                                    <div class="card-body">
                                        <div class="row">
                                            <div class="col-9">
                                                <div class="d-flex align-items-center align-self-start">
                                                    <h3 class="mb-0">$12.34</h3>
                                                    <p class="text-success ml-2 mb-0 font-weight-medium">+3.5%</p>
                                                </div>
                                            </div>
                                            <div class="col-3">
                                                <div class="icon icon-box-success">
                                                    <span class="mdi mdi-arrow-top-right icon-item"></span>
                                                </div>
                                            </div>
                                        </div>
                                        <h6 class="text-muted font-weight-normal">Potential growth</h6>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-3 col-sm-6 grid-margin stretch-card">
                                <div class="card">
                                    <div class="card-body">
                                        <div class="row">
                                            <div class="col-9">
                                                <div class="d-flex align-items-center align-self-start">
                                                    <h3 class="mb-0">$17.34</h3>
                                                    <p class="text-success ml-2 mb-0 font-weight-medium">+11%</p>
                                                </div>
                                            </div>
                                            <div class="col-3">
                                                <div class="icon icon-box-success">
                                                    <span class="mdi mdi-arrow-top-right icon-item"></span>
                                                </div>
                                            </div>
                                        </div>
                                        <h6 class="text-muted font-weight-normal">Revenue current</h6>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-3 col-sm-6 grid-margin stretch-card">
                                <div class="card">
                                    <div class="card-body">
                                        <div class="row">
                                            <div class="col-9">
                                                <div class="d-flex align-items-center align-self-start">
                                                    <h3 class="mb-0">$12.34</h3>
                                                    <p class="text-danger ml-2 mb-0 font-weight-medium">-2.4%</p>
                                                </div>
                                            </div>
                                            <div class="col-3">
                                                <div class="icon icon-box-danger">
                                                    <span class="mdi mdi-arrow-bottom-left icon-item"></span>
                                                </div>
                                            </div>
                                        </div>
                                        <h6 class="text-muted font-weight-normal">Daily Income</h6>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xl-3 col-sm-6 grid-margin stretch-card">
                                <div class="card">
                                    <div class="card-body">
                                        <div class="row">
                                            <div class="col-9">
                                                <div class="d-flex align-items-center align-self-start">
                                                    <h3 class="mb-0">$31.53</h3>
                                                    <p class="text-success ml-2 mb-0 font-weight-medium">+3.5%</p>
                                                </div>
                                            </div>
                                            <div class="col-3">
                                                <div class="icon icon-box-success">
                                                    <span class="mdi mdi-arrow-top-right icon-item"></span>
                                                </div>
                                            </div>
                                        </div>
                                        <h6 class="text-muted font-weight-normal">Expense current</h6>
                                    </div>
                                </div>
                            </div>
                        </div> -->
                        <div class="row">
                            <!-- <div class="col-md-4 grid-margin stretch-card">
                                <div class="card">
                                    <div class="card-body">
                                        <h4 class="card-title">Transaction History</h4>
                                        <canvas id="transaction-history" class="transaction-chart"></canvas>
                                        <div class="bg-gray-dark d-flex d-md-block d-xl-flex flex-row py-3 px-4 px-md-3 px-xl-4 rounded mt-3">
                                            <div class="text-md-center text-xl-left">
                                                <h6 class="mb-1">Transfer to Paypal</h6>
                                                <p class="text-muted mb-0">07 Jan 2019, 09:12AM</p>
                                            </div>
                                            <div class="align-self-center flex-grow text-right text-md-center text-xl-right py-md-2 py-xl-0">
                                                <h6 class="font-weight-bold mb-0">$236</h6>
                                            </div>
                                        </div>
                                        <div class="bg-gray-dark d-flex d-md-block d-xl-flex flex-row py-3 px-4 px-md-3 px-xl-4 rounded mt-3">
                                            <div class="text-md-center text-xl-left">
                                                <h6 class="mb-1">Tranfer to Stripe</h6>
                                                <p class="text-muted mb-0">07 Jan 2019, 09:12AM</p>
                                            </div>
                                            <div class="align-self-center flex-grow text-right text-md-center text-xl-right py-md-2 py-xl-0">
                                                <h6 class="font-weight-bold mb-0">$593</h6>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div> -->
                            <div class="col-md-12 grid-margin stretch-card">
                                <div class="card">
                                    <div class="card-body">
                                        <div class="d-flex flex-row justify-content-between">
                                            <h4 class="card-title mb-1">Open Events</h4>
                                            <p class="text-muted mb-1">Your data status</p>
                                        </div>
                                        <div class="row">
                                            <div class="col-12" id="event_container">
                                                <div class="preview-list">
                                                    <!-- <div class="preview-item border-bottom">
                                                        <div class="preview-thumbnail">
                                                            <div class="preview-icon bg-primary">
                                                                <i class="mdi mdi-file-document"></i>
                                                            </div>
                                                        </div>
                                                        <div class="preview-item-content d-sm-flex flex-grow">
                                                            <div class="flex-grow">
                                                                <h6 class="preview-subject">Admin dashboard design</h6>
                                                                <p class="text-muted mb-0">Broadcast web app mockup</p>
                                                            </div>
                                                            <div class="mr-auto text-sm-right pt-2 pt-sm-0">
                                                                <p class="text-muted">15 minutes ago</p>
                                                                <p class="text-muted mb-0">30 tasks, 5 issues</p>
                                                            </div>
                                                        </div>
                                                    </div> -->
                                                </div>
                                            </div>
                                        </div>
                                        <a href="./pages/forms/basic_elements.html" class="btn btn-outline-light mt-4">
                                            Create Event
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-12 grid-margin">
                                <div class="card">
                                    <div class="card-body">
                                        <h4 class="card-title">Order Status</h4>
                                        <div class="table-responsive">
                                            <table class="table">
                                                <thead>
                                                    <tr>
                                                        <!-- <th>
                                                            <div class="form-check form-check-muted m-0">
                                                                <label class="form-check-label">
                                                                    <input type="checkbox" class="form-check-input" />
                                                                </label>
                                                            </div>
                                                        </th> -->
                                                        <th>Client Email</th>
                                                        <th>Order No</th>
                                                        <th>Event</th>
                                                        <th>Proof Of Payment</th>
                                                        <th>Date</th>
                                                        <th>Payment Status</th>
                                                    </tr>
                                                </thead>
                                                <tbody></tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- content-wrapper ends -->
                    <!-- partial:partials/_footer.html -->
                    <footer class="footer">
                        <div class="d-sm-flex justify-content-center justify-content-sm-between">
                            <span class="text-muted d-block text-center text-sm-left d-sm-inline-block">Copyright ¬© bootstrapdash.com 2020</span>
                            <span class="float-none float-sm-right d-block mt-1 mt-sm-0 text-center">
                                Free <a href="https://www.bootstrapdash.com/bootstrap-admin-template/" target="_blank">Bootstrap admin templates</a> from Bootstrapdash.com</span
                            >
                        </div>
                    </footer>
                    <!-- partial -->
                </div>
                <!-- main-panel ends -->
            </div>
            <!-- page-body-wrapper ends -->
        </div>
        <!-- container-scroller -->
        <!-- plugins:js -->
        <script src="assetsStaff/vendors/js/vendor.bundle.base.js"></script>
        <!-- endinject -->
        <!-- Plugin js for this page -->
        <script src="assetsStaff/vendors/chart.js/Chart.min.js"></script>
        <script src="assetsStaff/vendors/progressbar.js/progressbar.min.js"></script>
        <script src="assetsStaff/vendors/jvectormap/jquery-jvectormap.min.js"></script>
        <script src="assetsStaff/vendors/jvectormap/jquery-jvectormap-world-mill-en.js"></script>
        <script src="assetsStaff/vendors/owl-carousel-2/owl.carousel.min.js"></script>
        <!-- End plugin js for this page -->
        <!-- inject:js -->
        <script src="assetsStaff/js/off-canvas.js"></script>
        <script src="assetsStaff/js/hoverable-collapse.js"></script>
        <script src="assetsStaff/js/misc.js"></script>
        <script src="assetsStaff/js/settings.js"></script>
        <script src="assetsStaff/js/todolist.js"></script>
        <!-- endinject -->
        <!-- Custom js for this page -->
        <script src="assetsStaff/js/dashboard.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
        <script>
            logoutBtn = document.getElementById("logout-btn");

            logoutBtn.addEventListener("click", function (e) {
                console.log("Logout clicked");
                if (logoutBtn) {
                    localStorage.removeItem("token");
                    localStorage.removeItem("user");
                    window.location.href = "login.html";
                }
            });
            const baseAPI = "http://localhost:8080/api";
            const token = localStorage.getItem("token");
            const user = JSON.parse(localStorage.getItem("user") || "{}");
            document.getElementById("username").innerHTML=user.name
            document.getElementById("username-navbar").innerHTML=user.name
            document.getElementById("role").innerHTML=user.role
            document.addEventListener("DOMContentLoaded", () => {
                if(user.role === "admin"){
                    console.log("Admin hanya bisa")
                    window.location.href="pages/tables/basic-table.html"
                }
            });
            async function fetchEvents() {
                let events;
                try {
                    const res = await fetch(`${baseAPI}/staff/viewEvents`, {
                        method: "GET",
                        headers: {
                            Authorization: `Bearer ${token}`,
                        },
                    });

                    events = await res.json();

                    if (!res.ok) {
                        console.log("Error getting events : ", events.data);
                        return;
                    }

                    console.log("Event data : ", events.data);
                } catch (err) {
                    console.error("Error getting events : ");
                }

                const previewList = document.querySelector("#event_container .preview-list");
                previewList.innerHTML = ""; // Clear old items

                events.data.forEach((event) => {
                    const item = document.createElement("div");
                    item.className = "preview-item border-bottom";
                    item.style.cursor = "pointer";

                    item.innerHTML = `
                        <div class="preview-thumbnail">
                            <div class="preview-icon bg-primary">
                                <i class="mdi mdi-file-document"></i>
                            </div>
                        </div>
                        <div class="preview-item-content d-sm-flex flex-grow">
                            <div class="flex-grow">
                                <h6 class="preview-subject">${event.title}</h6>
                                <p class="text-muted mb-0">Duration : ${event.event_days.length} days</p>
                            </div>
                            <div class="mr-auto text-sm-right pt-2 pt-sm-0">
                                <p class="text-muted">${new Date(event.created_at).toLocaleDateString()}</p>
                                <p class="text-muted mb-0">Max participants: ${event.max_participants}</p>
                            </div>
                        </div>
                    `;

                    item.addEventListener("click", () => {
                        showEventDetails(event);
                    });

                    previewList.appendChild(item);
                });
            }

            function showEventDetails(event) {
                const modalTitle = document.getElementById("eventModalLabel");
                const modalBody = document.getElementById("eventModalBody");
                const posterSrc = `/uploads/${event.poster_uri}`;
                console.log("poster src : ", posterSrc);
                // poster.style.display = "block";
                // poster.style.margin = "0 auto"; // center horizontally
                // poster.style.maxWidth = "100%"; // responsive inside modal
                // poster.alt = event.title || "Event poster";

                const daysHTML = event.event_days
                    .map((day, i) => {
                        return `
                        <div class="mb-3">
                            <strong>Day ${i + 1}</strong><br>
                            Date: ${new Date(day.date).toLocaleDateString()}<br>
                            Time: ${new Date(day.start_time).toLocaleTimeString()} - ${new Date(day.end_time).toLocaleTimeString()}<br>
                            Location: ${day.location}<br>
                            Speaker: ${day.speaker}<br>
                            Status: ${day.status ? "Active" : "Inactive"}
                        </div>
                    `;
                    })
                    .join("");

                modalBody.innerHTML = `
                    <div class="text-center mb-3">
                        <img id="eventPoster" src="${posterSrc}" alt="Event Poster" class="img-fluid rounded" style="max-height: 200px" />
                    </div>
                    <p><strong>Status:</strong> ${event.status ? "Active" : "Inactive"}</p>
                    <p><strong>Max Participants:</strong> ${event.max_participants}</p>
                    <p><strong>Price:</strong> $${event.price}</p>
                    <hr>
                    <div id="eventDaysContainer" style="max-height: 300px; overflow-y: auto;">
                        ${daysHTML}
                    </div>
                `;

                // Show modal
                const modal = new bootstrap.Modal(document.getElementById("eventModal"));
                modal.show();
            }

            function editEvent(eventId) {
                window.location.href = `/editEvent.html?id=${eventId}`;
            }


            let currentRegistration = null;

            function displayRegistrations(registrations) {
                const tbody = document.querySelector(".table tbody");
                if (!tbody) return;

                tbody.innerHTML = "";

                const badgeClass = (status) =>
                    ({
                        paid: "badge-outline-success",
                        pending: "badge-outline-warning",
                        rejected: "badge-outline-danger",
                    }[status] ?? "badge-outline-secondary");

                const nice = (str = "") => str.charAt(0).toUpperCase() + str.slice(1);

                registrations.forEach((reg, idx) => {
                    const row = document.createElement("tr");
                    row.style.cursor = "pointer";
                    row.style.borderBottom = "1px solid #444";
                    row.onclick = () => showRegistrationDetails(reg);

                    const proofCell = reg.proof_of_payment
                        ? `<a href="/uploads/${reg.proof_of_payment}" target="_blank" onclick="event.stopPropagation()" style="color: #667eea; text-decoration: none;">View</a>`
                        : "<span style='color: #666;'>‚Äî</span>";

                    row.innerHTML = `
                    <td style="padding: 12px;">
                        <div style="display: flex; align-items: center;">
                            <div style="width: 40px; height: 40px; border-radius: 50%; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; margin-right: 10px;">
                                ${reg.email.charAt(0).toUpperCase()}
                            </div>
                            <span>${reg.email}</span>
                        </div>
                    </td>
                    <td style="padding: 12px;">${reg._id?.slice(0, 6) || "‚Äî"}</td>
                    <td style="padding: 12px;">${reg.event?.title ?? "‚Äî"}</td>
                    <td style="padding: 12px;">${proofCell}</td>
                    <td style="padding: 12px;">${new Date(reg.created_at).toLocaleDateString()}</td>
                    <td style="padding: 12px;">
                        <span class="badge ${badgeClass(reg.status)}">
                            ${nice(reg.status)}
                        </span>
                    </td>
                `;
                    tbody.appendChild(row);
                });
            }

            function showRegistrationDetails(registration) {
                currentRegistration = registration;

                document.getElementById("detail-reg-id").textContent = registration._id || "‚Äî";
                document.getElementById("detail-email").textContent = registration.email || "‚Äî";
                document.getElementById("detail-reg-date").textContent = new Date(registration.created_at).toLocaleString();
                document.getElementById("detail-updated-date").textContent = new Date(registration.updated_at).toLocaleString();
                document.getElementById("detail-absence").textContent = registration.absence ? "‚ùå Absent" : "‚úÖ Present";
                document.getElementById("detail-qr-code").textContent = registration.qr_code || "Not generated";

                if (registration.event) {
                    document.getElementById("detail-event-title").textContent = registration.event.title || "‚Äî";
                    document.getElementById("detail-event-price").textContent = registration.event.price ? `$${registration.event.price}` : "‚Äî";
                    document.getElementById("detail-max-participants").textContent = registration.event.max_participants || "‚Äî";
                    document.getElementById("detail-total-registered").textContent = registration.event.total_registered || "‚Äî";
                    document.getElementById("detail-event-status").textContent = registration.event.status ? "‚úÖ Active" : "‚ùå Inactive";

                    const posterContainer = document.getElementById("detail-event-poster");
                    if (registration.event.poster_uri) {
                        posterContainer.innerHTML = `<img src="/uploads/${registration.event.poster_uri}" alt="Event Poster" class="reg-image" />`;
                    } else {
                        posterContainer.textContent = "No poster available";
                    }
                }

                const proofContainer = document.getElementById("detail-proof-container");
                if (user.role === "committee") {
                    proofContainer.innerHTML = "<span style='color: #666;'>Committee cannot view proof of payment.</span>";
                } else if (registration.proof_of_payment) {
                    proofContainer.innerHTML = `
                        <div>
                            <img src="/uploads/${registration.proof_of_payment}" alt="Proof of Payment" class="reg-proof-image" style="margin-bottom: 10px;" />
                            <br>
                            <a href="/uploads/${registration.proof_of_payment}" target="_blank" class="reg-btn reg-btn-link">
                                üîó View Full Size
                            </a>
                        </div>
                    `;
                } else {
                    proofContainer.innerHTML = "<span style='color: #666;'>No proof of payment uploaded</span>";
                }

                const statusSpan = document.getElementById("detail-current-status");
                const badgeClass = {
                    paid: "badge-outline-success",
                    pending: "badge-outline-warning",
                    rejected: "badge-outline-danger",
                }[registration.status] || "badge-outline-secondary";

                statusSpan.className = `badge ${badgeClass}`;
                statusSpan.textContent = registration.status.charAt(0).toUpperCase() + registration.status.slice(1);

                // Role-based UI
                const statusSection = document.querySelector(".reg-status-section");
                const certSection = document.getElementById("certificate-upload-section");

                if (user.role === "committee") {
                    statusSection.style.display = "none";

                    if (registration.absence === false) {
                        certSection.style.display = "block";
                    } else {
                        certSection.style.display = "none";
                    }
                } else {
                    statusSection.style.display = "block";
                    certSection.style.display = "none";
                }
                document.getElementById("registrationOverlay").style.display = "block";
                document.body.style.overflow = "hidden";
            }

            function closeRegistrationDetails() {
                document.getElementById("registrationOverlay").style.display = "none";
                document.body.style.overflow = "auto";
            }

            async function updateRegistrationStatus(newStatus) {
                if (!currentRegistration) return;

                if (confirm(`Are you sure you want to update the status to "${newStatus}"?`)) {
                    // Update the registration status
                    currentRegistration.status = newStatus;
                    currentRegistration.updated_at = new Date().toISOString();

                    // Update the status in the details view
                    const statusSpan = document.getElementById("detail-current-status");
                    const badgeClass =
                        {
                            paid: "badge-outline-success",
                            pending: "badge-outline-warning",
                            rejected: "badge-outline-danger",
                        }[newStatus] || "badge-outline-secondary";

                    statusSpan.className = `badge ${badgeClass}`;
                    statusSpan.textContent = newStatus.charAt(0).toUpperCase() + newStatus.slice(1);

                    // Update last updated time
                    document.getElementById("detail-updated-date").textContent = new Date().toLocaleString();

                    // Refresh the table

                    // Here you would make your API call
                    try {
                        const payload = {
                            registration_id: currentRegistration._id,
                            value: { status: newStatus, event_id: currentRegistration.event_id  },
                            updated_at: new Date().toISOString(),
                        };

                        console.log("Update payload : ", payload);

                        const res = await fetch(`${baseAPI}/staff/updateRegistration`, {
                            method: "PATCH",
                            headers: {
                                "Content-Type": "application/json",
                                Authorization: `Bearer ${token}`,
                            },
                            body: JSON.stringify(payload),
                        });

                        if (!res.ok) {
                            console.error("Update registration error");
                            // return;
                        }

                        const data = await res.json();
                        console.log("Update registration : ", data);
                    } catch (err) {
                        console.error("Error updating registration : ", err);
                    }

                    alert(`‚úÖ Status successfully updated to "${newStatus}"`);
                    // displayRegistrations();

                    console.log(`Status updated to: ${newStatus} for registration ID: ${currentRegistration._id}`);
                }
            }

            // Close overlay when clicking outside
            document.getElementById("registrationOverlay").addEventListener("click", function (e) {
                if (e.target === this) {
                    closeRegistrationDetails();
                }
            });

            // Close overlay with Escape key
            document.addEventListener("keydown", function (e) {
                if (e.key === "Escape") {
                    closeRegistrationDetails();
                }
            });

            async function checkStaff(e) {
                e.preventDefault();
                const token = localStorage.getItem("token");
                try {
                    const res = await fetch("http://localhost:8080/api/admin/checkStaff", {
                        method: "GET",
                        headers: {
                            Authorization: `Bearer ${token}`,
                        },
                    });

                    if (!res.ok) {
                        console.log("Gk boleh masuk");
                        window.location.href = "login.html";
                    }

                    console.log("Authorized");
                    // const data = await res.json();
                    // document.getElementByClass("main").style.display = "block";
                } catch (err) {
                    console.error("Error during initial GET request:", err);
                }
            }

            async function viewFinance() {
                try {
                    console.log("finance: ")
                    const res = await fetch(`${baseAPI}/staff/viewFinance`, {
                        method: "GET",
                        headers: {
                            Authorization: `Bearer ${token}`,
                        },
                    });

                    if (!res.ok) {
                        console.log("View finance error");
                    }

                    const result = await res.json();
                    console.log("View registrations : ", result.data);
                    displayRegistrations(result.data);
                } catch (err) {
                    console.error("Error viewing registrations : ", err);
                }
            }
            // Fetch and render events on page load
            async function viewRegistrationScan() {
                try {
                    const res = await fetch(`${baseAPI}/staff/viewRegistrationScan`, {
                        method: "GET",
                        headers: {
                            Authorization: `Bearer ${token}`,
                        },
                    });

                    if (!res.ok) {
                        console.log("View Registartion Scan error");
                    }

                    const result = await res.json();
                    console.log("View registrations : ", result.data);
                    displayRegistrations(result.data);
                } catch (err) {
                    console.error("Error viewing registrations : ", err);
                }
            }

             // Certificate Upload Handler
            document.getElementById("certificateUploadForm")?.addEventListener("submit", async function(e){
                e.preventDefault();
                const fileInput = document.getElementById("certificateFile");
                const file = fileInput.files[0];

                if (!file || !currentRegistration?._id) {
                    alert("Please select a file and valid registration.");
                    return;
                }

                const formData = new FormData();
                formData.append("certificate", file);
                formData.append("email", currentRegistration.email);
                formData.append("registration_id", currentRegistration._id);

                try {
                    const res = await fetch(`${baseAPI}/staff/createCertificate?email=${currentRegistration.email}&registId=${currentRegistration._id}`, {
                        method: "POST",
                        headers: {
                            Authorization: `Bearer ${token}`,
                        },
                        body: formData,
                    });

                    const result = await res.json();
                    if (res.ok && result.success) {
                        alert("‚úÖ Certificate uploaded successfully!");
                    } else {
                        alert("‚ùå Failed: " + result.message);
                    }
                } catch (err) {
                    console.error("Upload error:", err);
                    alert("‚ùå Upload failed.");
                }
            });


            document.addEventListener("DOMContentLoaded", checkStaff);

            if (user.role === "committee") {
                document.addEventListener("DOMContentLoaded", fetchEvents);
                document.addEventListener("DOMContentLoaded", viewRegistrationScan);
            } else if (user.role === "finance") {
                document.addEventListener("DOMContentLoaded", viewFinance);
            }

            // function onReady(callback) {
            //     if (document.readyState !== "loading") {
            //         callback();
            //     } else {
            //         document.addEventListener("DOMContentLoaded", callback);
            //     }
            // }

            // onReady(() => {
            //     if (user.role === "committee") {
            //         fetchEvents();
            //     } else if (user.role === "finance") {
            //         viewRegistrations();
            //         console.log("Already view");
            //     }
            // });
        </script>
    </body>
</html>
